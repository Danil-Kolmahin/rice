#!/usr/bin/env bash
set -euo pipefail

UNICODE_LIST="$HOME/.local/share/unicode-emoji-data.txt"

choice=$(
    awk -F\; '{print $1 "\t" $2}' "$UNICODE_LIST" \
    | while IFS=$'\t' read -r code name; do
        symbol=$(printf "%s" "$code" | xxd -r -p 2>/dev/null || true)
        printf "%s\tU+%s\t%s\n" "$symbol" "$code" "$name"
      done \
    | wmenu -N 000000 -n ffffff -M 000000 -m ffffff -S ffffff -s 000000 -i -p "unicode:" -f "IBM Plex Mono 14.5"
)

if [ -n "$choice" ]; then
    code=$(echo "$choice" | awk '{print $NF}' | sed 's/U+//')
    symbol=$(printf "%s" "$code" | xxd -r -p)
    printf "%s" "$symbol" # | wl-copy
fi
